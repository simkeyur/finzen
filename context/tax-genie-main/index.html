<!DOCTYPE html>
<html lang="en">
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="theme-color" content="#8b5cf6">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Smart Tax Genie - Tax Calculator</title>
    <meta name="description" content="Calculate your federal and state income taxes with our modern, intuitive tax calculator. Get instant estimates with a beautiful, jazzy interface.">
    <link rel="stylesheet" href="styles.css">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="apple-touch-icon" sizes="192x192" href="192x192.png">
    <link rel="apple-touch-icon" sizes="512x512" href="512x512.png">
</head>
<body>

    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="navbar-container">
            <button class="nav-tab active" data-view="manual">
                <span class="nav-tab-icon">‚úèÔ∏è</span>
                <span class="nav-tab-label">Manual Entry</span>
            </button>
            <button class="nav-tab" data-view="w2">
                <span class="nav-tab-icon">üìÑ</span>
                <span class="nav-tab-label">W-2 Import</span>
            </button>
        </div>
    </nav>

    <div class="main-container">
        
        <!-- Header -->
        <div class="header">
            <h1 class="main-title">Smart Tax Genie ‚ú®</h1>
            <p class="tax-deadline" id="tax-deadline">Loading...</p>
        </div>

        <!-- Manual Entry View -->
        <div id="manual-view" class="calculator-view">
        <!-- Input Form -->
        <div class="form-grid">
            <!-- Number of People -->
            <div class="form-group full-width">
                <label class="form-label">Number of People Filing</label>
                <div class="people-selector">
                    <button type="button" class="people-btn active" data-people="1">1 Person</button>
                    <button type="button" class="people-btn" data-people="2">2 People</button>
                </div>
            </div>

            <!-- Person 1 Income -->
            <div class="form-group">
                <label for="income1" class="form-label">Person 1 Income</label>
                <div class="currency-input">
                    <span class="currency-symbol">$</span>
                    <input type="number" id="income1" placeholder="85,000" class="form-input" step="0.01" min="0">
                </div>
            </div>

            <!-- Person 2 Income (hidden by default) -->
            <div class="form-group" id="person2-income-group" style="display: none;">
                <label for="income2" class="form-label">Person 2 Income</label>
                <div class="currency-input">
                    <span class="currency-symbol">$</span>
                    <input type="number" id="income2" placeholder="75,000" class="form-input" step="0.01" min="0" value="0">
                </div>
            </div>

            <!-- Filing Status -->
            <div class="form-group" id="filing-status-group">
                <label for="status" class="form-label">Filing Status</label>
                <select id="status" class="form-select">
                    <option value="single">Single</option>
                    <option value="head_of_household">Head of Household</option>
                </select>
            </div>

            <!-- State -->
            <div class="form-group">
                <label for="state" class="form-label">State of Residence</label>
                <select id="state" class="form-select">
                    <!-- States will be populated by JS -->
                </select>
            </div>

            <!-- Dependents -->
            <div class="form-group">
                <label for="dependents" class="form-label">Number of Dependents</label>
                <input type="number" id="dependents" placeholder="0" value="0" class="form-input" min="0" max="20">
            </div>

            <!-- Advanced Deductions Toggle -->
            <div class="form-group full-width">
                <button type="button" id="advanced-toggle" class="advanced-toggle">
                    <span>‚öôÔ∏è Advanced Deductions (401k, HSA...)</span>
                    <svg class="toggle-icon" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M6 9l6 6 6-6"/>
                    </svg>
                </button>
            </div>

            <!-- Advanced Deductions Section (Collapsible) -->
            <div id="advanced-deductions" class="advanced-deductions collapsed">
                <!-- Deduction Type -->
                <div class="form-group full-width">
                    <label class="form-label">Deduction Type</label>
                    <div class="deduction-selector">
                        <button type="button" class="deduction-btn active" data-deduction="standard">Standard</button>
                        <button type="button" class="deduction-btn" data-deduction="itemized">Itemized</button>
                    </div>
                </div>

                <!-- Itemized Deductions (Hidden by default) -->
                <div id="itemized-deductions" class="itemized-deductions" style="display: none;">
                    <div class="form-group">
                        <label for="mortgageInterest" class="form-label">Mortgage Interest</label>
                        <div class="currency-input">
                            <span class="currency-symbol">$</span>
                            <input type="number" id="mortgageInterest" placeholder="0" value="0" class="form-input" min="0" step="100">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="propertyTaxes" class="form-label">Property Taxes (SALT)</label>
                        <div class="currency-input">
                            <span class="currency-symbol">$</span>
                            <input type="number" id="propertyTaxes" placeholder="0" value="0" class="form-input" min="0" step="100">
                        </div>
                        <div class="contribution-info">
                            Max: $10,000 ($5,000 if married filing separately)
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="charitableDonations" class="form-label">Charitable Donations</label>
                        <div class="currency-input">
                            <span class="currency-symbol">$</span>
                            <input type="number" id="charitableDonations" placeholder="0" value="0" class="form-input" min="0" step="50">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="medicalExpenses" class="form-label">Medical Expenses</label>
                        <div class="currency-input">
                            <span class="currency-symbol">$</span>
                            <input type="number" id="medicalExpenses" placeholder="0" value="0" class="form-input" min="0" step="50">
                        </div>
                        <div class="contribution-info">
                            Only amounts exceeding 7.5% of AGI are deductible
                        </div>
                    </div>
                </div>

                <!-- 401K Contribution -->
                <div class="form-group">
                    <label for="contribution401k" class="form-label">401(k) Contribution</label>
                    <div class="currency-input">
                        <span class="currency-symbol">$</span>
                        <input type="number" id="contribution401k" placeholder="10,000" value="0" class="form-input" min="0" step="100">
                    </div>
                    <div class="contribution-info">
                        <span id="contribution-max">$23,500 per person</span>
                    </div>
                </div>

                <!-- HSA Contribution -->
                <div class="form-group">
                    <label for="contributionHsa" class="form-label">HSA Contribution</label>
                    <div class="currency-input">
                        <span class="currency-symbol">$</span>
                        <input type="number" id="contributionHsa" placeholder="4,300" value="0" class="form-input" min="0" step="50">
                    </div>
                    <div class="contribution-info">
                        $4,300 per person | $8,550 per family
                    </div>
                </div>

                <!-- Capital Loss -->
                <div class="form-group">
                    <label for="capitalLoss" class="form-label">Capital Loss (Stock Market)</label>
                    <div class="currency-input">
                        <span class="currency-symbol">$</span>
                        <input type="number" id="capitalLoss" placeholder="3,000" value="0" class="form-input" min="0" step="100">
                    </div>
                    <div class="contribution-info">
                        Max deduction: $3,000 ($1,500 if married filing separately)
                    </div>
                </div>
            </div>

        </div>
        
        <!-- Calculate Button -->
        <div style="text-align: center; margin-bottom: 1.5rem;">
            <button id="calculateBtn" class="calculate-btn">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/>
                    <path d="M5 3v4"/>
                    <path d="M19 17v4"/>
                    <path d="M3 5h4"/>
                    <path d="M17 19h4"/>
                </svg>
                <span id="btn-text">Calculate Taxes</span>
                <div id="loader" class="loader hidden"></div>
            </button>
        </div>

        <!-- Results Display -->
        <div id="results" class="hidden">
            <div class="results-summary">
                <div class="tax-line">
                    <span class="tax-label">Federal Income Tax</span>
                    <span id="federal-tax" class="tax-amount federal-tax"></span>
                </div>
                <div class="tax-line">
                    <span class="tax-label">State Income Tax</span>
                    <span id="state-tax" class="tax-amount state-tax"></span>
                </div>
                <div class="tax-line">
                    <span class="tax-label">Social Security Tax</span>
                    <span id="social-security-tax" class="tax-amount fica-tax"></span>
                </div>
                <div class="tax-line">
                    <span class="tax-label">Medicare Tax</span>
                    <span id="medicare-tax" class="tax-amount fica-tax"></span>
                </div>
                <div class="tax-line total-line">
                    <span class="tax-label">Total Tax (Income + FICA)</span>
                    <span id="total-tax" class="tax-amount total-tax"></span>
                </div>
                <div class="tax-line rate-line">
                    <span class="tax-label">Effective Tax Rate</span>
                    <span id="effective-rate" class="tax-amount effective-rate"></span>
                </div>
            </div>
                
            <!-- Tax Explanation -->
            <div id="tax-explanation" class="tax-explanation hidden">
                <h3>üí° Your Tax Breakdown</h3>
                <div id="explanation-content"></div>
            </div>
            
            <!-- Genie Savings Tips -->
            <div id="genie-section" class="genie-section hidden">
                <h3 class="genie-header">üßû‚Äç‚ôÇÔ∏è Genie's Magic Tax Saving Tips</h3>
                <div id="genie-tips" class="genie-tips"></div>
                <div id="genie-total" class="genie-total-box hidden">
                    <span class="genie-total-label">üéØ Total Potential Additional Savings</span>
                    <span id="genie-total-amount" class="genie-total-amount"></span>
                </div>
            </div>
            
            <p id="error-message" class="error-message hidden"></p>
        </div>
        </div>
        <!-- End Manual Entry View -->

        <!-- W-2 Import View -->
        <div id="w2-view" class="calculator-view hidden">
            <div class="w2-view-header">
                <h2>üìÑ W-2 Based Calculator</h2>
                <p class="w2-view-subtitle">Import your W-2 to calculate refund or amount owed</p>
            </div>

            <div class="form-grid">
                <!-- Filing Status Selection for W-2 -->
                <div class="form-group">
                    <label for="w2-filing-status" class="form-label">Filing Status</label>
                    <select id="w2-filing-status" class="form-select">
                        <option value="single">Single</option>
                        <option value="married_jointly">Married Filing Jointly</option>
                        <option value="married_separately">Married Filing Separately</option>
                        <option value="head_of_household">Head of Household</option>
                    </select>
                </div>

                <!-- State Selection for W-2 -->
                <div class="form-group">
                    <label for="w2-state" class="form-label">State of Residence</label>
                    <select id="w2-state" class="form-select">
                        <option value="CA">California</option>
                    </select>
                </div>
            </div>

            <!-- W-2 Import Buttons -->
            <div class="w2-import-buttons">
                <button type="button" id="w2-import-person1-btn" class="w2-import-btn w2-import-person-btn" data-person="1">
                    <span class="w2-btn-icon">üìÑ</span>
                    <div class="w2-btn-content">
                        <span class="w2-btn-title">Import Person 1 W-2</span>
                        <span class="w2-btn-subtitle" id="w2-status-person1">Not imported</span>
                    </div>
                </button>
                <button type="button" id="w2-import-person2-btn" class="w2-import-btn w2-import-person-btn" data-person="2" style="display: none;">
                    <span class="w2-btn-icon">üìÑ</span>
                    <div class="w2-btn-content">
                        <span class="w2-btn-title">Import Person 2 W-2</span>
                        <span class="w2-btn-subtitle" id="w2-status-person2">Not imported</span>
                    </div>
                </button>
            </div>

            <!-- Calculate Button -->
            <div style="text-align: center; margin-bottom: 1.5rem;">
                <button id="w2-calculate-btn" class="calculate-btn" disabled>
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/>
                        <path d="M5 3v4"/>
                        <path d="M19 17v4"/>
                        <path d="M3 5h4"/>
                        <path d="M17 19h4"/>
                    </svg>
                    <span id="w2-btn-text">Calculate Taxes</span>
                    <div id="w2-loader" class="loader hidden"></div>
                </button>
            </div>

            <!-- W-2 Results Display -->
            <div id="w2-results" class="hidden">
                <div class="results-summary">
                    <div class="tax-line">
                        <span class="tax-label">Federal Income Tax</span>
                        <span id="w2-federal-tax" class="tax-amount federal-tax"></span>
                    </div>
                    <div class="tax-line">
                        <span class="tax-label">State Income Tax</span>
                        <span id="w2-state-tax" class="tax-amount state-tax"></span>
                    </div>
                    <div class="tax-line">
                        <span class="tax-label">Social Security Tax</span>
                        <span id="w2-social-security-tax" class="tax-amount fica-tax"></span>
                    </div>
                    <div class="tax-line">
                        <span class="tax-label">Medicare Tax</span>
                        <span id="w2-medicare-tax" class="tax-amount fica-tax"></span>
                    </div>
                    <div class="tax-line total-line">
                        <span class="tax-label">Total Tax Owed</span>
                        <span id="w2-total-tax" class="tax-amount total-tax"></span>
                    </div>
                    <div class="tax-line withheld-line">
                        <span class="tax-label">Total Withheld</span>
                        <span id="w2-total-withheld" class="tax-amount withheld-amount"></span>
                    </div>
                    <div class="tax-line refund-line">
                        <span class="tax-label" id="w2-refund-label">Estimated Refund</span>
                        <span id="w2-refund-amount" class="tax-amount refund-amount"></span>
                    </div>
                    <div class="tax-line rate-line">
                        <span class="tax-label">Effective Tax Rate</span>
                        <span id="w2-effective-rate" class="tax-amount effective-rate"></span>
                    </div>
                </div>
                    
                <!-- Tax Explanation -->
                <div id="w2-tax-explanation" class="tax-explanation hidden">
                    <h3>üí° Your Tax Breakdown</h3>
                    <div id="w2-explanation-content"></div>
                </div>
                
                <!-- Genie Savings Tips -->
                <div id="w2-genie-section" class="genie-section hidden">
                    <h3 class="genie-header">üßû‚Äç‚ôÇÔ∏è Genie's Magic Tax Saving Tips</h3>
                    <div id="w2-genie-tips" class="genie-tips"></div>
                    <div id="w2-genie-total" class="genie-total-box hidden">
                        <span class="genie-total-label">üéØ Total Potential Additional Savings</span>
                        <span id="w2-genie-total-amount" class="genie-total-amount"></span>
                    </div>
                </div>
                
                <p id="w2-error-message" class="error-message hidden"></p>
            </div>
        </div>
        <!-- End W-2 Import View -->
        
        <!-- Reset Button and PWA Install -->
        <div class="reset-container">
            <button id="install-btn" class="reset-btn" style="display: none;" title="Install as app on your device">
                üì± Install App
            </button>
            <button id="reset-btn" class="reset-btn" title="Reset all inputs and clear saved data">
                üîÑ Reset App
            </button>
        </div>
    </div>

    <!-- iOS Install Modal -->
    <div id="ios-install-modal" class="modal hidden">
        <div class="modal-content">
            <button class="modal-close" id="modal-close">√ó</button>
            <h2 class="modal-title">üì± Install on iOS</h2>
            <div class="modal-body">
                <p class="modal-text">To install this app on your iPhone or iPad:</p>
                <ol class="install-steps">
                    <li>
                        <span class="step-icon">1Ô∏è‚É£</span>
                        <span>Tap the <strong>Share</strong> button <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: inline; vertical-align: middle;"><path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"/><polyline points="16 6 12 2 8 6"/><line x1="12" y1="2" x2="12" y2="15"/></svg> at the bottom of Safari</span>
                    </li>
                    <li>
                        <span class="step-icon">2Ô∏è‚É£</span>
                        <span>Scroll down and tap <strong>"Add to Home Screen"</strong> <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: inline; vertical-align: middle;"><rect x="3" y="3" width="18" height="18" rx="2"/><line x1="12" y1="8" x2="12" y2="16"/><line x1="8" y1="12" x2="16" y2="12"/></svg></span>
                    </li>
                    <li>
                        <span class="step-icon">3Ô∏è‚É£</span>
                        <span>Tap <strong>"Add"</strong> in the top right corner</span>
                    </li>
                </ol>
                <p class="modal-note">üí° The app will appear on your home screen like a native app!</p>
            </div>
        </div>
    </div>

    <!-- W-2 Import Modal -->
    <div id="w2-modal" class="modal hidden">
        <div class="modal-content w2-modal-content">
            <div class="modal-header">
                <h2>üìÑ Import from W-2 Form</h2>
                <button id="w2-modal-close" class="modal-close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <p class="modal-instruction">Enter the values from your W-2 form boxes. Match the numbers from your physical W-2.</p>
                
                <div class="w2-form-grid">
                    <!-- Box 1: Wages -->
                    <div class="w2-field">
                        <label for="w2-box1" class="w2-label">
                            <span class="box-number">1</span>
                            <span class="box-title">Wages, tips, other comp.</span>
                        </label>
                        <div class="currency-input">
                            <span class="currency-symbol">$</span>
                            <input type="number" id="w2-box1" placeholder="0.00" class="form-input" step="0.01" min="0">
                        </div>
                    </div>

                    <!-- Box 2: Federal income tax withheld -->
                    <div class="w2-field">
                        <label for="w2-box2" class="w2-label">
                            <span class="box-number">2</span>
                            <span class="box-title">Federal income tax withheld</span>
                        </label>
                        <div class="currency-input">
                            <span class="currency-symbol">$</span>
                            <input type="number" id="w2-box2" placeholder="0.00" class="form-input" step="0.01" min="0">
                        </div>
                    </div>

                    <!-- Box 3: Social Security wages -->
                    <div class="w2-field">
                        <label for="w2-box3" class="w2-label">
                            <span class="box-number">3</span>
                            <span class="box-title">Social security wages</span>
                        </label>
                        <div class="currency-input">
                            <span class="currency-symbol">$</span>
                            <input type="number" id="w2-box3" placeholder="0.00" class="form-input" step="0.01" min="0">
                        </div>
                    </div>

                    <!-- Box 4: Social Security tax withheld -->
                    <div class="w2-field">
                        <label for="w2-box4" class="w2-label">
                            <span class="box-number">4</span>
                            <span class="box-title">Social security tax withheld</span>
                        </label>
                        <div class="currency-input">
                            <span class="currency-symbol">$</span>
                            <input type="number" id="w2-box4" placeholder="0.00" class="form-input" step="0.01" min="0">
                        </div>
                    </div>

                    <!-- Box 5: Medicare wages -->
                    <div class="w2-field">
                        <label for="w2-box5" class="w2-label">
                            <span class="box-number">5</span>
                            <span class="box-title">Medicare wages and tips</span>
                        </label>
                        <div class="currency-input">
                            <span class="currency-symbol">$</span>
                            <input type="number" id="w2-box5" placeholder="0.00" class="form-input" step="0.01" min="0">
                        </div>
                    </div>

                    <!-- Box 6: Medicare tax withheld -->
                    <div class="w2-field">
                        <label for="w2-box6" class="w2-label">
                            <span class="box-number">6</span>
                            <span class="box-title">Medicare tax withheld</span>
                        </label>
                        <div class="currency-input">
                            <span class="currency-symbol">$</span>
                            <input type="number" id="w2-box6" placeholder="0.00" class="form-input" step="0.01" min="0">
                        </div>
                    </div>

                    <!-- Box 12: Deferred compensation -->
                    <div class="w2-field w2-field-box12">
                        <label class="w2-label">
                            <span class="box-number">12</span>
                            <span class="box-title">See instructions for box 12</span>
                        </label>
                        <div class="box12-grid">
                            <div class="box12-code-group">
                                <label for="w2-box12-code" class="w2-sublabel">Code</label>
                                <select id="w2-box12-code" class="form-select">
                                    <option value="">None</option>
                                    <option value="D">D - 401(k)</option>
                                    <option value="E">E - 403(b)</option>
                                    <option value="F">F - SEP</option>
                                    <option value="G">G - 457(b)</option>
                                    <option value="S">S - SIMPLE</option>
                                    <option value="W">W - HSA</option>
                                </select>
                            </div>
                            <div class="box12-amount-group">
                                <label for="w2-box12-amount" class="w2-sublabel">Amount</label>
                                <div class="currency-input">
                                    <span class="currency-symbol">$</span>
                                    <input type="number" id="w2-box12-amount" placeholder="0.00" class="form-input" step="0.01" min="0">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Box 17: State income tax -->
                    <div class="w2-field">
                        <label for="w2-box17" class="w2-label">
                            <span class="box-number">17</span>
                            <span class="box-title">State income tax</span>
                        </label>
                        <div class="currency-input">
                            <span class="currency-symbol">$</span>
                            <input type="number" id="w2-box17" placeholder="0.00" class="form-input" step="0.01" min="0">
                        </div>
                    </div>
                </div>

                <div class="modal-actions">
                    <button type="button" id="w2-cancel-btn" class="secondary-btn">Cancel</button>
                    <button type="button" id="w2-import-submit-btn" class="primary-btn">
                        <span id="w2-import-btn-text">Import Values</span>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Load the JavaScript module -->
    <script src="script.js"></script>
    <script>
        // Register Service Worker for PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./service-worker.js')
                    .then(registration => console.log('‚úÖ Service Worker registered'))
                    .catch(err => console.log('‚ùå Service Worker registration failed:', err));
            });
        }
    </script>

</body>
</html>


